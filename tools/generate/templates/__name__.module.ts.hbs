import { Module } from '@nestjs/common';
import { CqrsModule } from '@nestjs/cqrs';
import { TypeOrmModule } from '@nestjs/typeorm';

// CONTROLLERS
import { __Name__Controller } from './infrastructure/http/controllers/__name__.controller';

// REPOSITORIES (Domain Port & Infrastructure Implementation)
import { __Name__Repository } from './domain/repositories/__name__.repository';
import { __Name__TypeormRepository } from './infrastructure/database/typeorm/repositories/__name__-typeorm.repository';
import { __Name__Schema } from './infrastructure/database/typeorm/entities/__name__.schema';

// USE CASES (Command & Query Handlers)
import { Create__Name__UseCase } from './application/use-cases/create-__name__.use-case';
import { FindAll__Names__UseCase } from './application/use-cases/find-all-__names__.use-case';
import { Get__Name__ByIdUseCase } from './application/use-cases/get-__name__-by-id.use-case';

// Libs do Nest-DDD-Hex-Base
import { UnitOfWork } from '../../../libs/ddd/domain/base-classes/unit-of-work';
import { ExceptionHelper } from '../../../libs/exception-helper';

const useCases = [
  Create__Name__UseCase,
  FindAll__Names__UseCase,
  Get__Name__ByIdUseCase,
];

@Module({
  imports: [CqrsModule, TypeOrmModule.forFeature([__Name__Schema])],
  controllers: [__Name__Controller],
  providers: [
    ...useCases,
    UnitOfWork,
    ExceptionHelper,
    // Provide Domain Repository Port with Infrastructure Implementation
    {
      provide: __Name__Repository,
      useClass: __Name__TypeormRepository,
    },
  ],
  exports: [
    __Name__Repository,
    UnitOfWork,
  ],
})
export class __Name__Module {}
